# Лабораторная работа №4

`Русакова Елена Дмитриевна`

ИСУ `367519`

группа `P3317`

# Телеграмм бот для контроля за финансами 

@mmy_money_bot

## Требования

+ Добавляешь свои категории, можно добавить всякие необычные
+ Вводишь имеющуюся сумму, в любой момент можно добавить новый доход
+ Каждую трату записываешь в бота, выбрав нужную категорию (можно добавить новую категорию при необходимости)
+ В любой момент можешь получить статистку всех трат за текущую неделю

Отличие от любого приложения банка
- можно добавить свою необычную категорию 
- маркетплейсы, супермаркеты и переводы могут включать в себя любые категории, а в банке они будут одной
- в банках бывают неправильные категории 
- не нужно открывать другое приложение, тг открыто почти всегда


## Реализация

Для Telegram Bot Api была использована библиотека [morse](https://github.com/Otann/morse/tree/master).

Для хранения данных была использована база данных PostgreSQL.

### Функции бота

+ `/start` Чтобы начать пользоваться ботом

В базе данных создается запись о пользователе и оправляется ему список всех комнад бота, а если она уже есть, то ему напоминаются все команды бота.

Если записи о пользователе нет в базе данных, он не сможет сделать никакое дейтсвие с ботом.

+ `/help` Чтобы узнать все что умеет бот

Пользователь получает список всех команд бота

+ `/my_category` Посмотреть свои категории

Из базы данных выводятся все категории пользователя, а если их нет пользователь получает сообщение об этом

+ `/add_new_category <категория>` Чтобы добавить новую категорию

Добавляется новая категория пользователя в базу данных, если такой еще нет

+ `/update_category <старая категория> <новая категория>` Чтобы заменить старую категорию на новую

Категория переименовывается в базе данных, если имена категорий совпадают, такой категории нет или уже категория с именем новой, то пользователь получит сообщение об ошибке

+ `/delete_category <категория>` Чтобы удалить категорию и все траты этой категории

Категория удаляется из базы данных, вместе со всеми тратами из этой категории

+ `/add_income <доход>` Чтобы добавить доход

Сумма денег пользователя в базе данных увеличивается. Если было введено отрицательное число или не число, то пользователь получит сообщение об ошибке

+ `/my_money` Чтобы узнать остаток средств

Выводится сумма денег пользователя в базе данных

+ `/add_spending <категория> <трата>` Чтобы добавить трату в категорию

В базу данных добавляется запись о трате с указанием категории, также проводится проверка, что такая категория строка и она существует и что трата это положительное число, в случае ошибки, пользователь получает сообщение о ней

+ `/delete_spendings` Чтобы удалить все траты пользователя

Все записи о тратах пользователя удаляются из базы данных, но записи о самом пользователе и его категориях остаются

+ `/stat_category <категория>` Чтобы получить статистику по категории

Выводится статистика трат с начала календарной недели по категории, список всех трат с днем недели, сумма всех трат, количество трат

+ `/stat` Чтобы узнать статистику по всем категория

Выводится статистика по всем имеющимся категориям пользователя


## Пример работы бота

![](/images/ex1.png)

![](/images/ex2.png)

![](/images/ex3.png)

![](/images/ex4.png)

## Вывод
Во время выполнения лабораторной работы, я познакомилась с Telegram Bot API и с работой с базой данных postgresql в функциональном языке программирования Clojure и создала своего телеграмм бота.

